{% extends "base.html" %}


{% block head %}
<title>
    My Flask App
</title>
{% endblock %}


{% block body %}
<div class = "Content">
    <h1>Contact Manager</h1>
    <form action="/" method="get" style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
        <input type="text" name="search" placeholder="Search by name" value="{{ search_query|default('') }}">
        <input type="submit" value="Search" class="add">
        <a href="{{ url_for('export_contacts') }}" class="add" style="margin-left: 0;">Download CSV</a>
    </form>
    {% if contacts | length < 1 %}
    <h3>No contacts to show</h3>
    {% else %}
<table>
    <tr>
        <th>Name</th>
        <th>Number</th>
        <th>Actions</th>    
    </tr>
    {% for contact in contacts %}
    <tr>
        <td>{{ contact.name }}</td>
        <td>{{ contact.number }}</td>
        <td>
            <a href="{{ url_for('delete', id=contact.id) }}" class="delete-link" onclick="return confirmDelete(event);">Delete</a>
            <br/>
            <a href="{{ url_for('update', id=contact.id) }}">Edit</a>
        </td>
    </tr>
    {% endfor %}
</table>
    {% endif %}
    <form action = "/" method = "POST">
        <input type="text" name="name" id="name" placeholder="Name" required>
        <input type="text" name="number" id="number" placeholder="Number" required>
        <input type="submit" value="Add Contact" class="add">
    </form>
</div>
<script>
function confirmDelete(event) {
    if (!confirm('Are you sure you want to delete this contact?')) {
        event.preventDefault();
        return false;
    }
    return true;
}
</script>
{% endblock %}
